{"ast":null,"code":"import React,{useState,useCallback,useRef}from'react';import{MapContainer,TileLayer,Marker,useMapEvents,useMap}from'react-leaflet';import'leaflet/dist/leaflet.css';import{OpenStreetMapProvider}from'leaflet-geosearch';import L from'leaflet';import icon from'leaflet/dist/images/marker-icon.png';import iconShadow from'leaflet/dist/images/marker-shadow.png';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";let DefaultIcon=L.icon({iconUrl:icon,shadowUrl:iconShadow,iconSize:[25,41],iconAnchor:[12,41]});L.Marker.prototype.options.icon=DefaultIcon;function Location(_ref){let{onLocationChange}=_ref;const[position,setPosition]=useState([60.876549,-162.460444]);const[address,setAddress]=useState('');const[suggestions,setSuggestions]=useState([]);const provider=new OpenStreetMapProvider();const mapRef=useRef(null);function LocationMarker(){const map=useMap();useMapEvents({click(e){const newPosition=[e.latlng.lat,e.latlng.lng];setPosition(newPosition);onLocationChange(newPosition);}});return position===null?null:/*#__PURE__*/_jsx(Marker,{position:position});}const handleAddressSearch=useCallback(()=>{provider.search({query:address}).then(results=>{if(results.length>0){const newPosition=[results[0].y,results[0].x];setPosition(newPosition);onLocationChange(newPosition);if(mapRef.current){mapRef.current.setView(newPosition,12);}}});},[address,onLocationChange,provider]);const handleInputChange=useCallback(async event=>{const input=event.target.value;setAddress(input);if(input.length>2){const results=await provider.search({query:input});setSuggestions(results.slice(0,5));}else{setSuggestions([]);}},[provider]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"location\",children:\"Location:\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:address,onChange:handleInputChange,placeholder:\"Enter an address\",list:\"address-suggestions\"}),/*#__PURE__*/_jsx(\"datalist\",{id:\"address-suggestions\",children:suggestions.map((suggestion,index)=>/*#__PURE__*/_jsx(\"option\",{value:suggestion.label},index))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleAddressSearch,children:\"Search\"})]}),/*#__PURE__*/_jsxs(MapContainer,{center:position,zoom:12,style:{height:'300px',width:'100%'},ref:mapRef,children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(LocationMarker,{})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Selected: \",position[0].toFixed(6),\", \",position[1].toFixed(6)]})]});}export default Location;","map":{"version":3,"names":["React","useState","useCallback","useRef","MapContainer","TileLayer","Marker","useMapEvents","useMap","OpenStreetMapProvider","L","icon","iconShadow","jsx","_jsx","jsxs","_jsxs","DefaultIcon","iconUrl","shadowUrl","iconSize","iconAnchor","prototype","options","Location","_ref","onLocationChange","position","setPosition","address","setAddress","suggestions","setSuggestions","provider","mapRef","LocationMarker","map","click","e","newPosition","latlng","lat","lng","handleAddressSearch","search","query","then","results","length","y","x","current","setView","handleInputChange","event","input","target","value","slice","children","htmlFor","type","onChange","placeholder","list","id","suggestion","index","label","onClick","center","zoom","style","height","width","ref","url","toFixed"],"sources":["/Users/wmobley/Documents/GitHub/SiteStoriesForm/src/location.js"],"sourcesContent":["import React, { useState, useCallback, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, useMapEvents, useMap } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { OpenStreetMapProvider } from 'leaflet-geosearch';\nimport L from 'leaflet';\nimport icon from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\n\nlet DefaultIcon = L.icon({\n  iconUrl: icon,\n  shadowUrl: iconShadow,\n  iconSize: [25, 41],\n  iconAnchor: [12, 41]\n});\n\nL.Marker.prototype.options.icon = DefaultIcon;\n\nfunction Location({ onLocationChange }) {\n  const [position, setPosition] = useState([60.876549, -162.460444]);\n  const [address, setAddress] = useState('');\n  const [suggestions, setSuggestions] = useState([]);\n  const provider = new OpenStreetMapProvider();\n  const mapRef = useRef(null);\n\n  function LocationMarker() {\n    const map = useMap();\n\n    useMapEvents({\n      click(e) {\n        const newPosition = [e.latlng.lat, e.latlng.lng];\n        setPosition(newPosition);\n        onLocationChange(newPosition);\n      },\n    });\n\n    return position === null ? null : (\n      <Marker position={position}></Marker>\n    );\n  }\n\n  const handleAddressSearch = useCallback(() => {\n    provider.search({ query: address }).then(results => {\n      if (results.length > 0) {\n        const newPosition = [results[0].y, results[0].x];\n        setPosition(newPosition);\n        onLocationChange(newPosition);\n        if (mapRef.current) {\n          mapRef.current.setView(newPosition, 12);\n        }\n      }\n    });\n  }, [address, onLocationChange, provider]);\n\n  const handleInputChange = useCallback(async (event) => {\n    const input = event.target.value;\n    setAddress(input);\n    if (input.length > 2) {\n      const results = await provider.search({ query: input });\n      setSuggestions(results.slice(0, 5));\n    } else {\n      setSuggestions([]);\n    }\n  }, [provider]);\n\n  return (\n    <div>\n      <label htmlFor=\"location\">Location:</label>\n      <div>\n        <input\n          type=\"text\"\n          value={address}\n          onChange={handleInputChange}\n          placeholder=\"Enter an address\"\n          list=\"address-suggestions\"\n        />\n        <datalist id=\"address-suggestions\">\n          {suggestions.map((suggestion, index) => (\n            <option key={index} value={suggestion.label} />\n          ))}\n        </datalist>\n        <button type=\"button\" onClick={handleAddressSearch}>Search</button>\n      </div>\n      <MapContainer center={position} zoom={12} style={{ height: '300px', width: '100%' }} ref={mapRef}>\n        <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\n        <LocationMarker />\n      </MapContainer>\n      <p>Selected: {position[0].toFixed(6)}, {position[1].toFixed(6)}</p>\n    </div>\n  );\n}\n\nexport default Location;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}