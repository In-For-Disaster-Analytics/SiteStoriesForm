{"ast":null,"code":"import React,{useState}from'react';import Location from'./location';import{saveAudioToIndexedDB,getAudioFromIndexedDB}from'./db';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function RegistrationForm(_ref){let{onSubmitSuccess}=_ref;const[name,setName]=useState('');const[title,setTitle]=useState('');const[description,setDescription]=useState('');const[time,setTime]=useState('');const[location,setLocation]=useState('');const[audioFile,setAudioFile]=useState(null);const[notes,setNotes]=useState('');const saveFormDataToFile=null;saveFormDataToFile=async formData=>{try{const handle=await window.showSaveFilePicker({suggestedName:\"\".concat(formData.title,\".mp3\"),types:[{description:'MP3 Audio',accept:{'audio/mpeg':['.mp3']}}]});const writable=await handle.createWritable();await writable.write(formData.audioFile);await writable.close();console.log(handle);console.log('File saved successfully');}catch(err){console.error('Error saving file:',err);}};const handleAudioFileChange=e=>{const file=e.target.files[0];if(file){console.log(file);setAudioFile(file.name?file:null);}};const handleSubmit=async e=>{e.preventDefault();try{const audioFileId=await saveAudioToIndexedDB(audioFile,title);const newFormData={id:Date.now(),name,title,description,time,location,audioFileId,notes};// Retrieve existing data\nconst existingData=JSON.parse(localStorage.getItem('siteStoryFormData'))||[];// Append new data\nconst updatedData=[...existingData,newFormData];// Save updated data back to localStorage\nlocalStorage.setItem('siteStoryFormData',JSON.stringify(updatedData));console.log('Form data appended to localStorage:',newFormData);console.log('Total entries:',updatedData.length);// Confirm data storage\ntry{const storedData=await getAudioFromIndexedDB(audioFileId);console.log('Stored audio data:',storedData);}catch(error){console.error('Error retrieving audio data:',error);}onSubmitSuccess();}catch(error){console.error('Error saving form data:',error);}};// const handleSubmit = async (e) => {\n//   e.preventDefault();\n//   const newFormData = {\n//     id: Date.now(),\n//     name,\n//     title,\n//     description,\n//     time,\n//     location,\n//     audioFileName: audioFile ? audioFile.name : null,\n//     audioFile: audioFile,\n//     notes\n//   };\n//   // Retrieve existing data\n//   const existingData = JSON.parse(localStorage.getItem('siteStoryFormData')) || [];\n//   // Append new data\n//   const updatedData = [...existingData, newFormData];\n//   // Save updated data back to localStorage\n//   localStorage.setItem('siteStoryFormData', JSON.stringify(updatedData));\n//   localStorage.setItem(newFormData.title, audioFile);\n//   console.log(localStorage)\n//   // Save file locally\n//   // await saveFormDataToFile(newFormData);\n//   console.log('Form data appended to localStorage:', newFormData);\n//   console.log('Total entries:', updatedData.length);\n//   // Optionally, reset form fields here\n//   onSubmitSuccess();\n// };\nreturn/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"registration-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Title\",children:\"Title:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",value:title,onChange:e=>setTitle(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Description\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",value:description,onChange:e=>setDescription(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"Interviewer Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",value:name,onChange:e=>setName(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"time\",children:\"Time:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",id:\"time\",value:time,onChange:e=>setTime(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"registration-form\",children:/*#__PURE__*/_jsx(Location,{onLocationChange:setLocation})}),/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"audio\",children:\"Audio Narrative Location:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"audio\",accept:\".mp3\",onChange:handleAudioFileChange,required:true}),audioFile&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Selected file: \",audioFile.name]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"registration-form\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"notes\",children:\"Notes:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"notes\",value:notes,onChange:e=>setNotes(e.target.value)})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:\"Register\"})]});}export default RegistrationForm;","map":{"version":3,"names":["React","useState","Location","saveAudioToIndexedDB","getAudioFromIndexedDB","jsx","_jsx","jsxs","_jsxs","RegistrationForm","_ref","onSubmitSuccess","name","setName","title","setTitle","description","setDescription","time","setTime","location","setLocation","audioFile","setAudioFile","notes","setNotes","saveFormDataToFile","formData","handle","window","showSaveFilePicker","suggestedName","concat","types","accept","writable","createWritable","write","close","console","log","err","error","handleAudioFileChange","e","file","target","files","handleSubmit","preventDefault","audioFileId","newFormData","id","Date","now","existingData","JSON","parse","localStorage","getItem","updatedData","setItem","stringify","length","storedData","onSubmit","className","children","htmlFor","type","value","onChange","required","onLocationChange"],"sources":["/Users/wmobley/Documents/GitHub/SiteStoriesForm/src/registrationForm.js"],"sourcesContent":["\nimport React, { useState } from 'react';\nimport Location from './location';\nimport { saveAudioToIndexedDB, getAudioFromIndexedDB} from './db';\n\n\n\n\nfunction RegistrationForm({onSubmitSuccess}) {\n    const [name, setName] = useState('');\n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n  \n    const [time, setTime] = useState('');\n    const [location, setLocation] = useState('');\n    const [audioFile, setAudioFile] = useState(null);\n    const [notes, setNotes] = useState('');\n    const saveFormDataToFile =null;\nsaveFormDataToFile = async (formData) => {\n  try {\n    const handle = await window.showSaveFilePicker({\n      suggestedName: `${formData.title}.mp3`,\n      types: [{\n        description: 'MP3 Audio',\n        accept: {'audio/mpeg': ['.mp3']},\n      }],\n    });\n    const writable = await handle.createWritable();\n    await writable.write(formData.audioFile);\n    await writable.close();\n    console.log(handle);\n    console.log('File saved successfully');\n  } catch (err) {\n    console.error('Error saving file:', err);\n  }\n};\n\n\n    const handleAudioFileChange = (e) => {\n      const file = e.target.files[0];\n      if (file) {\n        console.log(file);\n        setAudioFile(file.name ? file : null);\n      }\n    };\n    const handleSubmit = async (e) => {\n      e.preventDefault();\n    \n      try {\n        const audioFileId = await saveAudioToIndexedDB(audioFile, title);\n    \n        const newFormData = {\n          id: Date.now(),\n          name,\n          title,\n          description,\n          time,\n          location,\n          audioFileId,\n          notes\n        };\n    \n        // Retrieve existing data\n        const existingData = JSON.parse(localStorage.getItem('siteStoryFormData')) || [];\n    \n        // Append new data\n        const updatedData = [...existingData, newFormData];\n    \n        // Save updated data back to localStorage\n        localStorage.setItem('siteStoryFormData', JSON.stringify(updatedData));\n    \n        console.log('Form data appended to localStorage:', newFormData);\n        console.log('Total entries:', updatedData.length);\n         // Confirm data storage\n        try{\n            const storedData = await getAudioFromIndexedDB(audioFileId);\n            console.log('Stored audio data:', storedData);\n        } catch(error){\n          console.error('Error retrieving audio data:', error);\n        }\n        onSubmitSuccess();\n      } catch (error) {\n        console.error('Error saving form data:', error);\n      }\n    };\n\n    // const handleSubmit = async (e) => {\n    //   e.preventDefault();\n  \n    //   const newFormData = {\n    //     id: Date.now(),\n    //     name,\n    //     title,\n    //     description,\n    //     time,\n    //     location,\n    //     audioFileName: audioFile ? audioFile.name : null,\n    //     audioFile: audioFile,\n    //     notes\n    //   };\n    \n      \n    \n    //   // Retrieve existing data\n    //   const existingData = JSON.parse(localStorage.getItem('siteStoryFormData')) || [];\n    \n    //   // Append new data\n    //   const updatedData = [...existingData, newFormData];\n    \n    //   // Save updated data back to localStorage\n    //   localStorage.setItem('siteStoryFormData', JSON.stringify(updatedData));\n    //   localStorage.setItem(newFormData.title, audioFile);\n    //   console.log(localStorage)\n    //   // Save file locally\n    //   // await saveFormDataToFile(newFormData);\n    //   console.log('Form data appended to localStorage:', newFormData);\n    //   console.log('Total entries:', updatedData.length);\n    \n    //   // Optionally, reset form fields here\n    //   onSubmitSuccess();\n    // };\n  \n    return (\n      <form onSubmit={handleSubmit} className=\"registration-form\">\n        <div className=\"registration-form\">\n          <label htmlFor=\"Title\">Title:</label>\n          <input\n          type=\"text\"\n            id=\"title\"\n            value={title}\n            onChange={(e) => setTitle(e.target.value)}\n          ></input>\n        </div>\n        <div className=\"registration-form\">\n          <label htmlFor=\"Description\">Description:</label>\n          <textarea\n            id=\"description\"\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n          ></textarea>\n        </div>\n        <div className=\"registration-form\">\n          <label htmlFor=\"name\">Interviewer Name:</label>\n          <input\n            type=\"text\"\n            id=\"name\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n            required\n          />\n        </div>\n        <div className=\"registration-form\">\n          <label htmlFor=\"time\">Time:</label>\n          <input\n            type=\"datetime-local\"\n            id=\"time\"\n            value={time}\n            onChange={(e) => setTime(e.target.value)}\n            required\n          />\n        </div>\n        <div className=\"registration-form\">\n          <Location onLocationChange={setLocation} />\n        </div>\n        <div className=\"registration-form\">\n  <label htmlFor=\"audio\">Audio Narrative Location:</label>\n  <input\n          type=\"file\"\n          id=\"audio\"\n          accept=\".mp3\"\n          onChange={handleAudioFileChange}\n          required\n        />\n        {audioFile && <p>Selected file: {audioFile.name}</p>}\n      </div>\n        <div className=\"registration-form\">\n          <label htmlFor=\"notes\">Notes:</label>\n          <textarea\n            id=\"notes\"\n            value={notes}\n            onChange={(e) => setNotes(e.target.value)}\n          ></textarea>\n        </div>\n        <button type=\"submit\" className=\"submit-button\">Register</button>\n      </form>\n    );\n  }\n  export default RegistrationForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}